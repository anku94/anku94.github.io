(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[256],{9026:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return BudgetDataSankey}});var a=o(7437),s=o(5100),n=o(2265),r=o(7022),i=o(9489);let Defaults=class Defaults{};Defaults.SANKEY_EDGE_COLOR=0;let SankeyUtils=class SankeyUtils{static processSankeySectionExtent(e,t){if(!e.pos)return{};let{x:o,y:a}=e.pos;o=t.levels[e.level];let s={};return e.edges.forEach(e=>{let t=e[1];s[t]={x:o,y:a}}),s}static removeUnconnectedNodes(e){let t={nodes:{},edges:[],positions:{}};t.edges=e.edges;let o=[...e.edges.map(e=>e.src),...e.edges.map(e=>e.dest)],a=new Map(o.map(e=>[e,!0]));for(let[o,s]of Object.entries(e.nodes))a.has(o)&&(t.nodes[o]=s);for(let[o,s]of Object.entries(e.positions))a.has(o)&&(t.positions[o]=s);return t}static fillUnallocatedEdge(e){let t=new Map;for(let o of(console.log("In Fill Unallocated Edge: ",e.edges),e.edges)){let e=t.get(o.src)||0;t.set(o.src,e-o.value);let a=t.get(o.dest)||0;t.set(o.dest,a+o.value)}console.log("Node Map: ",t);let o=e.edges.map(e=>(-1==e.value&&(console.log(e),e.value=t.get(e.src)),e));return{nodes:e.nodes,edges:o,positions:e.positions}}static processSankeySection(e,t){if(!e.active)return{nodes:{},edges:[],positions:{}};let o={nodes:e.nodes,edges:e.edges.map(t=>({src:t[0],dest:t[1],value:t[2],color:e.linkcolor||Defaults.SANKEY_EDGE_COLOR})),positions:SankeyUtils.processSankeySectionExtent(e,t)};if(o=SankeyUtils.removeUnconnectedNodes(o),!e.group||e.group&&!e.group.display)return o;let a=e.group;o.nodes[a.id]=a.name,o.positions[a.id]=a.pos,o.positions[a.id].x=t.levels[e.level+1];let s=[];return e.edges.forEach(t=>{s.push({src:t[1],dest:a.id,value:t[2],color:e.linkcolor||Defaults.SANKEY_EDGE_COLOR})}),console.log("Nodes: ",o.nodes),console.log("Generated edges: ",s),o.edges=o.edges.concat(s),o}static mergeGraphData(e){let t=e.metadata.root,o=e.metadata.position,a={levels:e.metadata.levels},s={nodes:{},edges:[],positions:{}};s.positions[t]=o,e.data.forEach(e=>{let{nodes:t,edges:o,positions:n}=SankeyUtils.processSankeySection(e,a);console.log("Processed Data: ",t,o,n),Object.assign(s.nodes,t),Object.assign(s.positions,n),s.edges.push(...o)});let n=SankeyUtils.fillUnallocatedEdge(s);return console.log("Merged Data: ",s),console.log("Merged DataUnAlloc: ",n),n}};function constructAbbrevIndexMap(e){let t=new Map,o=0;return Object.keys(e).forEach(e=>{t.has(e)||t.set(e,o++)}),t}function convertGraphDataToPlotData(e){let t=SankeyUtils.mergeGraphData(e),o=t.nodes,a=constructAbbrevIndexMap(o),s=a.size,n=Object.values(o),r=Array.from({length:s},()=>void 0);a.forEach((e,o)=>{r[e]=t.positions[o]});let l=t.edges,c=i.Z.light5v3,d={label:n,link:{source:l.map(e=>a.get(e.src)),target:l.map(e=>a.get(e.dest)),value:l.map(e=>e.value/8500),color:l.map(e=>c[e.color])},node:{x:r.map(e=>(null==e?void 0:e.x)||0),y:r.map(e=>(null==e?void 0:e.y)||0)}};return console.log("Plot Data: ",d),d}var SankeyPlotData=async function(e){try{let t=await fetch(e);if(!t.ok)throw Error("HTTP error! Status: ".concat(t.status));let o=await t.json();return convertGraphDataToPlotData(o)}catch(e){throw console.error("Failed to fetch graph data:",e),e}},BudgetDataSankey=()=>{let{state:e,dispatch:t}=(0,n.useContext)(s.I),o={type:"sankey",orientation:"h",arrangement:"snap",domain:{x:[0,1],y:[0,1]},node:{pad:15,thickness:30,line:{color:"black",width:.5}},valuesuffix:"B",valueformat:"$.0f"},[i,l]=(0,n.useState)([o]);return(0,n.useEffect)(()=>{SankeyPlotData("/dash/data/goi2324/sankey.v2.json").then(e=>{var t,a;l([{...o,node:{...o.node,label:e.label,x:null===(t=e.node)||void 0===t?void 0:t.x,y:null===(a=e.node)||void 0===a?void 0:a.y},link:e.link}])})},[e.key]),(0,a.jsx)(r.Z,{data:i,layout:{font:{size:12},width:1280,height:840,margin:{t:20,b:240,l:0,r:0,pad:2}}})}},9489:function(e,t){"use strict";t.Z={default40:["#ace","#5474e5","#b3bd33","#904cc4","#65c14c","#d25fc8","#3f9130","#a579e2","#869b32","#625bb2","#cea339","#6c97de","#da582f","#3abec8","#df405f","#4ec480","#dc4493","#58c8a9","#b33969","#63a669","#8b4791","#abbd6c","#4d68a7","#8a6d21","#b999e0","#5d792d","#b670b0","#35773e","#e184b0","#3c9779","#b33931","#4da9d9","#a05c2f","#206e54","#e7827a","#5c5e1e","#954b6d","#948f50","#a85558","#d69f6a"],light5:["rgb(102,225,208)","rgb(241,164,212)","rgb(150,225,127)","rgb(163,201,254)","rgb(225,202,105)"],light5v2:["rgb(179,192,178)","rgb(224,199,206)","rgb(219,230,213)","rgb(173,192,207)","rgb(192,219,234)"],light5v3:["rgba(132,196,175,0.3)","rgba(201,171,208,0.3)","rgba(183,187,146,0.3)","rgba(156,181,226,0.3)","rgba(224,169,166,0.3)","rgba(112,189,204,0.3)","rgba(129,187,222,0.3)","rgba(140,177,189,0.3)","rgba(153,191,203,0.3)","rgba(140,177,189,0.3)"]}},3018:function(e,t,o){"use strict";var a=o(1289);function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction,e.exports=function(){function shim(e,t,o,s,n,r){if(r!==a){var i=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function getShim(){return shim}shim.isRequired=shim;var e={array:shim,bigint:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return e.PropTypes=e,e}},4275:function(e,t,o){e.exports=o(3018)()},1289:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}}]);