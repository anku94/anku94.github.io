(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[104],{8668:function(e,t,a){Promise.resolve().then(a.bind(a,9234))},5100:function(e,t,a){"use strict";a.d(t,{I:function(){return n},W:function(){return AppStateProvider}});var r=a(7437),s=a(2265);let l={key:0,title:"GOI Budget 2023-24",selected_csv:"/dash/data/goi2324.v2/goi.csv"};function AppStateReducer(e,t){switch(t.type){case"REFRESH":return{...e,key:e.key+1};case"RESET":return l;case"SET_TITLE":return{...e,title:t.title};case"SET_CSV":return{...e,selected_csv:t.csv};case"SET_TITLE_AND_CSV":let a="/dash/data/goi2324.v2/".concat(t.csv,".csv");return{...e,title:t.title,selected_csv:a};default:return e}}let n=(0,s.createContext)({state:l,dispatch:()=>{}}),AppStateProvider=e=>{let{children:t}=e,[a,i]=(0,s.useReducer)(AppStateReducer,l);return(0,r.jsx)(n.Provider,{value:{state:a,dispatch:i},children:t})}},9234:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Page}});var r=a(7437),s=a(2265),l=a(3857),n=a(8938),i=a(9050),o=a(8874),d=a(6055),c=a(5100),u=a(9248),b=a(1709),h=a(9042),m=a(6921),_=a(7543),f=a(4368),v=a(2750),g=a(724);let x=[{field:"id",headerName:"ID",width:150},{field:"source_abbrev",headerName:"srckey",width:150},{field:"source_name",headerName:"srcname",width:150},{field:"dest_abbrev",headerName:"destkey",width:150},{field:"dest_name",headerName:"Ministry/Department",width:450},{field:"amount",headerName:"Amount",width:150},{field:"amount_inr",headerName:"Amount_INR",width:150},{field:"amount_usd",type:"number",headerName:"Amount (USD, $)",width:150,valueFormatter:e=>{if(null==e.value)return"";let t=e.value/1e9,a=t.toFixed(2);return"$".concat(a,"B")}}];function CustomGridToolbar(){return(0,r.jsxs)(b.D,{children:[(0,r.jsx)(h.S,{}),(0,r.jsx)(m.M,{}),(0,r.jsx)(_.L,{}),(0,r.jsx)(f.Zh,{}),(0,r.jsx)(v.T,{})]})}var BudgetDataGrid=()=>{let[e,t]=s.useState([]),{state:a,dispatch:l}=(0,s.useContext)(c.I);return(s.useEffect(()=>{let e=new u.Z;e.read(a.selected_csv).then(e=>{let a=e.map((e,t)=>(e.id=t,e));t(a)})},[a.selected_csv]),0==e.length)?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsx)("div",{style:{height:400},children:(0,r.jsx)(g._$,{filterMode:"client",initialState:{columns:{columnVisibilityModel:{id:!1,source_abbrev:!1,dest_abbrev:!1,amount:!1,amount_inr:!1}},sorting:{sortModel:[{field:"amount_usd",sort:"desc"}]},filter:{filterModel:{items:[],quickFilterValues:[""]}},pagination:{paginationModel:{pageSize:10}}},slots:{toolbar:CustomGridToolbar},rows:e,columns:x,onRowClick:e=>{let t=e.row.dest_abbrev,a=e.row.dest_name,r=t.replace("g2_","");console.log("Changing to: ",r),l({type:"SET_TITLE_AND_CSV",title:a,csv:r})}})})},p=a(8811),w=a.n(p);let T=w()(()=>Promise.all([a.e(934),a.e(901),a.e(305)]).then(a.bind(a,305)).then(e=>e.default),{loadableGenerated:{webpack:()=>[305]},ssr:!1});function Page(){let{state:e,dispatch:t}=(0,s.useContext)(c.I);return(0,r.jsxs)("div",{children:[(0,r.jsx)(l.ZP,{}),(0,r.jsxs)(n.Z,{maxWidth:"xl",sx:{mt:1,mb:0},children:[(0,r.jsx)(o.ZP,{children:(0,r.jsxs)(o.ZP,{item:!0,xs:12,children:[(0,r.jsx)(i.Z,{onClick:()=>{t({type:"RESET"})},children:"Reset"}),(0,r.jsx)(i.Z,{onClick:()=>{t({type:"REFRESH"})},children:"Refresh"}),"(Click on a box!)"]})}),(0,r.jsxs)(o.ZP,{container:!0,spacing:3,columnSpacing:0,sx:{p:0},children:[(0,r.jsx)(o.ZP,{item:!0,xs:12,md:8,lg:12,children:(0,r.jsx)(d.Z,{sx:{p:0,display:"flex",flexDirection:"column",height:720},children:(0,r.jsx)(T,{})})}),(0,r.jsx)(o.ZP,{item:!0,xs:12,children:(0,r.jsx)(d.Z,{sx:{p:2,display:"flex",flexDirection:"column"},children:(0,r.jsx)(BudgetDataGrid,{})})})]})]})]})}},9248:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var r=a(1812),s=a.n(r),l={default40:["#ace","#5474e5","#b3bd33","#904cc4","#65c14c","#d25fc8","#3f9130","#a579e2","#869b32","#625bb2","#cea339","#6c97de","#da582f","#3abec8","#df405f","#4ec480","#dc4493","#58c8a9","#b33969","#63a669","#8b4791","#abbd6c","#4d68a7","#8a6d21","#b999e0","#5d792d","#b670b0","#35773e","#e184b0","#3c9779","#b33931","#4da9d9","#a05c2f","#206e54","#e7827a","#5c5e1e","#954b6d","#948f50","#a85558","#d69f6a"]};let DataTreeUtils=class DataTreeUtils{static buildTree(e){let t=new Map;return e.forEach(e=>{t.has(e.source_abbrev)||t.set(e.source_abbrev,{children:new Set,level:0}),t.has(e.dest_abbrev)||t.set(e.dest_abbrev,{children:new Set,level:0}),t.get(e.source_abbrev).children.add(e.dest_abbrev)}),t}static setTreeLevels(e,t,a){let r=e.get(t);r&&(r.level=a,r.children.forEach(t=>{DataTreeUtils.setTreeLevels(e,t,a+1)}))}static assignColors(e,t){let a=DataTreeUtils.buildTree(e),r=e[0].source_abbrev;DataTreeUtils.setTreeLevels(a,r,1);let s=new Map;a.forEach((e,t)=>{let a=e.level;s.has(a)||s.set(a,0),s.set(a,s.get(a)+1)}),console.log("Level Counts: ",s);let l=1;for(let[e,t]of s)if(t>1){l=e;break}let n=new Map,i=1,assignColor=(e,r,s)=>{console.log("Assigning color to: ",e,s,l);let o=a.get(e);if(o){if(s<l)n.set(e,t[0]);else if(s==l){let a=i%t.length;console.log("Setting color: ",a),n.set(e,t[a]),i++}else{let t=n.get(r);n.set(e,t)}o.children.forEach(t=>{assignColor(t,e,s+1)})}};assignColor(r,"",1);let o=e.map(e=>n.get(e.dest_abbrev));return console.log("Colors: ",o),o}};let CsvReader=class CsvReader{async read(e){let t=await fetch(e),a=await t.text(),r=s().parse(a,{header:!0}),l=[];for(let e of r.data)console.log(e),e.amount&&l.push({source_name:e.source_name,dest_name:e.dest_name,source_abbrev:e.source_abbrev,dest_abbrev:e.dest_abbrev,amount:e.amount,amount_inr:e.amount_inr,amount_usd:e.amount_usd});return l}async get_dno_edges(e){console.log("Loading URL: ",e);let t=await this.read(e),a={};for(let e of t){let t=e.source_abbrev,r=e.dest_abbrev,s=e.amount_usd;a[t]=(a[t]||0)+Number(s),a[r]=(a[r]||0)+Number(s)}let r=t.filter(e=>{let t=e.source_abbrev,r=e.dest_abbrev;return a[t],a[r]>4e8});return r.length<8&&(r=t),{parents:r.map(e=>e.source_abbrev),ids:r.map(e=>e.dest_abbrev),labels:r.map(e=>e.dest_name),values:r.map(e=>e.amount_usd/1e9),marker:{color:DataTreeUtils.assignColors(r,l.default40)}}}constructor(){}};var n=CsvReader}},function(e){e.O(0,[979,666,913,738,971,472,744],function(){return e(e.s=8668)}),_N_E=e.O()}]);